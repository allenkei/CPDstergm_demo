annotate("text",
x = c(34.5, 56),       # center of each box horizontally
y = c(200, 350),       # center vertically
label = c("I", "II"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
active_data <- raster_data[raster_data$value == 1, ]
active_data$edge_index <- as.numeric(factor(active_data$edge_id))
range(active_data$edge_index)
highlight_boxes <- data.frame(
xmin = c(30, 95),
xmax = c(39, 110),
ymin = c(150, 1),
ymax = c(250, 2459), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(34.5, 56),       # center of each box horizontally
y = c(200, 350),       # center vertically
label = c("I", "II"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(30, 95),
xmax = c(39, 115),
ymin = c(150, 1),
ymax = c(250, 2459), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(34.5, 56),       # center of each box horizontally
y = c(200, 350),       # center vertically
label = c("I", "II"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
2459/2
highlight_boxes <- data.frame(
xmin = c(30, 95),
xmax = c(39, 115),
ymin = c(150, 1),
ymax = c(250, 2459), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(34.5, 105),       # center of each box horizontally
y = c(200, 1230),       # center vertically
label = c("I", "II"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(30, 95),
xmax = c(39, 115),
ymin = c(150, 1),
ymax = c(250, 2459), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 5),
xmax = c(115, 93),
ymin = c(1, 500),
ymax = c(2459, 1000), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 5),
xmax = c(115, 93),
ymin = c(1, 900),
ymax = c(2459, 1700), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 5),
xmax = c(115, 93),
ymin = c(1, 900),
ymax = c(2459, 1500), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 5),
xmax = c(115, 93),
ymin = c(1, 900),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 1),
xmax = c(115, 93),
ymin = c(1, 900),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 1),
xmax = c(115, 93),
ymin = c(1, 800),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 1),
xmax = c(115, 93),
ymin = c(1, 900),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 1),
xmax = c(115, 93),
ymin = c(1, 1000),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 1),
xmax = c(115, 93),
ymin = c(1, 1100),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95, 1),
xmax = c(115, 93),
ymin = c(1, 1000),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95,   1,    1),
xmax = c(115,  93,   93),
ymin = c(1,    1000, 500),
ymax = c(2459, 1600, 1000), # 2459 is the number of active edges
label = c("I", "II", "III")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time", y = "Edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95,   1,    ),
xmax = c(115,  93,  ),
ymin = c(1,    500, ),
ymax = c(2459, 1600,), # 2459 is the number of active edges
label = c("I", "II", "III")
)
highlight_boxes <- data.frame(
xmin = c(95,   1    ),
xmax = c(115,  93  ),
ymin = c(1,    500 ),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II", "III")
)
highlight_boxes <- data.frame(
xmin = c(95,   1    ),
xmax = c(115,  93  ),
ymin = c(1,    500 ),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time point", y = "Active edge") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.6)
highlight_boxes <- data.frame(
xmin = c(95,   1    ),
xmax = c(115,  93  ),
ymin = c(1,    500 ),
ymax = c(2459, 1600), # 2459 is the number of active edges
label = c("I", "II")
)
ggplot(raster_data[raster_data$value == 1, ], aes(x = time, y = as.numeric(factor(edge_id)))) +
geom_tile(fill = "black") +
# Highlight boxes
geom_rect(data = highlight_boxes,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "blue", alpha = 0.15, color = "blue", inherit.aes = FALSE) +
# Add text labels inside boxes
annotate("text",
x = c(105),       # center of each box horizontally
y = c(1230),       # center vertically
label = c("I"),
size = 5, fontface = "bold", color = "blue") +
labs(x = "Time points", y = "Active edges") +
theme_minimal() +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
geom_vline(xintercept = change_points, color = "red", linewidth = 0.5)
#library(devtools)
#install_github("allenkei/CPDstergm", force = TRUE)
library(CPDstergm)
source("EVAL.R")
?CPD_STERGM
#library(devtools)
#install_github("allenkei/CPDstergm", force = TRUE)
library(CPDstergm)
source("EVAL.R")
data("MITphone")
result <- CPD_STERGM(MITphone, directed=FALSE, network_stats=c("edges", "isolates", "triangles"),
list_of_lambda=10^c(0:4), threshold_alpha = 0.05)
theta_change <- result$theta_change; threshold <- result$threshold; xtick <- result$est_CP
seq_date <- seq(as.Date("2004-09-15"), as.Date("2005-05-04"), by="days"); tau <- length(seq_date)-1
plot(1:length(theta_change), theta_change, type='l',ylab="", xlab="", xaxt="n", yaxt="n")
abline(h = threshold, col='red',lwd=2)
result
result$est_CP
#library(devtools)
#install_github("allenkei/CPDstergm", force = TRUE)
library(CPDstergm)
data("MITphone")
length(MITphone)
dim(MITphone[[1]])
dim(MITphone[[1]])[1]
seq_len(length(MITphone))
node_degree <- rep(0, dim(MITphone[[1]])[1])
for (t in seq_len(length(MITphone))) {
mat <- adj_list[[t]]
total_degree <- total_degree + rowSums(mat)
}
node_degree <- rep(0, dim(MITphone[[1]])[1])
for (t in seq_len(length(MITphone))) {
mat <- MITphone[[t]]
total_degree <- total_degree + rowSums(mat)
}
node_degree <- rep(0, dim(MITphone[[1]])[1])
for (t in seq_len(length(MITphone))) {
mat <- MITphone[[t]]
total_degree <- node_degree + rowSums(mat)
}
median(total_degree)
total_degree
seq_len(length(MITphone))
rowSums(mat)
node_degree <- rep(0, dim(MITphone[[1]])[1])
for (t in seq_len(length(MITphone))) {
mat <- MITphone[[t]]
total_degree <- node_degree + rowSums(mat)
}
total_degree
node_degree <- rep(0, dim(MITphone[[1]])[1])
data("MITphone")
node_degree <- rep(0, dim(MITphone[[1]])[1])
for (t in seq_len(length(MITphone))) {
mat <- MITphone[[t]]
node_degree <- node_degree + rowSums(mat)
}
node_degree
degree_median <- median(node_degree)
node_status <- ifelse(node_degree > degree_median, "A", "N")
print(node_status)
#library(devtools)
#install_github("allenkei/CPDstergm", force = TRUE)
library(CPDstergm)
data("MITphone")
node_degree <- rep(0, dim(MITphone[[1]])[1])
for (t in seq_len(length(MITphone))) {
mat <- MITphone[[t]]
node_degree <- node_degree + rowSums(mat)
}
degree_median <- median(node_degree)
node_status <- ifelse(node_degree > degree_median, "A", "N")
result <- CPD_STERGM(MITphone, directed=FALSE, network_stats=c("edges", "isolates", "triangles", "nodematch(\"Gender\")"),
node_attr=node_status, list_of_lambda=10^c(0:4))
result$est_CP
theta_change <- result$theta_change; threshold <- result$threshold; xtick <- result$est_CP
seq_date <- seq(as.Date("2004-09-15"), as.Date("2005-05-04"), by="days"); tau <- length(seq_date)-1
plot(1:length(theta_change), theta_change, type='l',ylab="", xlab="", xaxt="n", yaxt="n")
theta_change <- result$theta_change; threshold <- result$threshold; xtick <- result$est_CP
seq_date <- seq(as.Date("2004-09-15"), as.Date("2005-05-04"), by="days"); tau <- length(seq_date)-1
par(mar=c(4, 4, 2, 1), fig=c(0,1,0,0.66))
plot(1:length(theta_change), theta_change, type='l',ylab="", xlab="", xaxt="n", yaxt="n")
abline(h = threshold, col='red',lwd=2)
plot(1:length(theta_change), theta_change, type='l',ylab="", xlab="", xaxt="n", yaxt="n")
abline(h = threshold, col='red',lwd=2)
# winter and spring vacation (duration): seq_date[95];seq_date[110];seq_date[188];seq_date[192]
win_spr_break <- c(95,110,188,192)
for(i in c(1,3)){
rect(xleft = win_spr_break[i]-2, xright = win_spr_break[i+1]-2, ybottom = par("usr")[3], ytop = par("usr")[4],
border = NA, col = adjustcolor("grey", alpha = 0.4))
}
axis(side=1, at=xtick-2, labels = F, lwd = 0, lwd.ticks = 1)
text(x=xtick-8,  par("usr")[3]-2, labels = seq_date[xtick], srt=45, cex=0.7, xpd=TRUE)
